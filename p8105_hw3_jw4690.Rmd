---
title: "p8105_hw3_jw4690"
author: "Jingxi Wang"
date: "2024-10-10"
output: github_document
---
```{r setup, echo = FALSE, message = FALSE}
library(tidyverse)
library(patchwork)
```

## Problem 1

```{r}
library(p8105.datasets)
data("ny_noaa")
```

```{r}
ny_noaa_df = ny_noaa |>
  filter(!is.na(date),
         !is.na(tmax),
         !is.na(tmin)) |>
  mutate(year = year(date),
         month = month(date),
         day = day(date)) |>
  mutate(tmin = as.numeric(tmin) / 10,
         tmax = as.numeric(tmax) / 10)
```

This dataset has 7 variables and 2595176 observations. The key variables include date, sonwfall, prcp, max temperature, and min temperature.

```{r}
# find the most commonly observed values for snowfall

snowfall_counts = ny_noaa_df |>
  count(snow, name = "n_obs")

common_snowfall = snowfall_counts |>
  filter(n_obs == max(n_obs))
```

The most commonly observed values for snowfall is `r common_snowfall$snow`. I think it's because snowfall only occurs during certain month, while for much of the year, no snow is recorded, and even during winter month, many days may still have no snowfall.

```{r}
avg_max_Jan = ny_noaa_df|>
  group_by(year) |>
  filter(month == 1) |>
  summarize(
    mean_tmax = mean(tmax, na.rm = TRUE))

Jan_plot = avg_max_Jan |>
  ggplot(aes(x = year, y = mean_tmax)) +
  geom_point(alpha = .5) +
  labs(title = "Average max temperature in January", y = "Average max temperature(°C)")
  theme(legend.position = "none")
```

```{r}
avg_max_July = ny_noaa_df|>
  group_by(year) |>
  filter(month == 7) |>
  summarize(
    mean_tmax = mean(tmax, na.rm = TRUE))

July_plot = avg_max_July |>
  ggplot(aes(x = year, y = mean_tmax)) +
  geom_point(alpha = .5) +
  labs(title = "Average max temperature in July", y = "Average max temperature(°C)")
  theme(legend.position = "none")
```

```{r}
Jan_plot + July_plot
```

In January, temperatures are typically lower, reflecting the winter season. The temperature distribution tends to be centered around 0°C. 
In July, temperatures tend to be higher due to the summer season. There are some instances of extremely low temperatures in July, which are considered outliers.

```{r}
tmax_tmin = ny_noaa_df |>
  ggplot(aes(x = tmin, y = tmax)) +
  geom_hex(bins = 50) +
  labs(title = "tmax vs tmin", x = "min temperature(°C)", y = "max temperature°C")
```

```{r}
snowfall_df = ny_noaa_df |>
  filter(snow > 0 & snow < 100)

snowfall_plot = snowfall_df |>
  ggplot(aes(x = snow, fill = factor(year))) +
  geom_density(alpha = .3) +
  labs(title = "Distribution of snowfall by year", x = "snowfall")
```

```{r}
tmax_tmin / snowfall_plot
```

The first panel uses a hexbin plot to represent the relationship between tmax and tmin, which helps visualize the density of temperature observations.
The second panel shows the distribution of snowfall (between 0 and 100 mm) separately for each year, highlighting seasonal patterns or anomalies in snowfall over time.

